<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Draw With Me</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/pesquisa.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="retornar()">
  <div class="menu">
    <div class="opcoes_menu">
      <a style="text-decoration: underline #f75a5a 4px; color: black" href="pesquisa.html">Você Sabia?</a>
      <a href="index.html">JOGO</a>
    </div>
  </div>

  <div class="conteudo">
    <div class="container">
      <div>
        <img src="assets/image/draw.jpg" alt="" />
      </div>

      <div class="historia">
        <h1>Sobre o Site</h1>
        <h2>O que é?</h2>
        <p>
          O <b>Draw With Me</b> é um jogo criado especialmente para crianças.
          Com a proposta simples, mas com um imenso poder: desenharem juntas
          de forma colaborativa e também divertida. Brincar é essencial para o
          desenvolvimento emocional e social infantil. Pois, o isolamento pode
          afetar essas áreas com o tempo. A ideia do jogo é de prevenir esse
          tipo de afastamento desde cedo. Através de atividades criativas e
          interativas, as crianças poderão criar desenhos juntas e fortalecer
          vínculos.
          <span style="color: rgb(0, 0, 0); background-color: #6de1d2">⬇(Mais para baixo...)</span>
        </p>
      </div>
    </div>

    <div class="container">
      <div class="historia">
        <h2>Quem é o Autor?</h2>
        <p style="font-size: 22px">
          Meu nome é <b>Anne Y. Yamasaki</b>, aluna do 1º semestre da SPTech
          em ADS. Tenho 23 anos e meu hobby favorito é desenhar,
          principalmente no estilo mangá. As pessoas costumam me perguntar
          quando esse "dom" em desenhos surgiu. A verdade é que sempre fui uma
          criança solitária, que sempre nos intervalos estava desenhando. E a
          razão é: porque eu sofri bullying. Isso me fez parar de brincar com
          outras crianças e me afastar de todos. E aos 15 anos de idade fui
          diagnosticada com depressão. Todo esse isolamento constante acabou
          contribuindo para o surgimento da depressão e de outras dificuldades
          emocionais. Essa experiência marcou profundamente quem eu sou, e foi
          justamente por isso que decidi criar este projeto: para que outras
          crianças não passem pelo mesmo.
          <b style="color: #ffa955">
            <i>
              Quero oferecer um espaço onde elas possam se conectar, brincar e
              se expressar juntas, usando a arte como ponte para a empatia, a
              criatividade e a saúde emocional.
            </i>
          </b>
        </p>
      </div>

      <div>
        <img src="assets/image/eu.jpg" style="width: 350px" alt="" />
      </div>
    </div>

    <div class="grafico"><canvas id="canvas_grafico_afastamento"></canvas></div>
    <div class="grafico"><canvas id="canvas_grafico_motivo"></canvas></div>

  </div>

  <div class="rodape">
    <p>Projeto dedicado pela aluna, Anne Y. Yamasaki - 1ADS/2025</p>
  </div>
</body>

</html>
<script>

  var qtd_sim_noBancoVar = 0;
  var qtd_nao_noBancoVar = 0;
  var percentual_sim;
  var percentual_nao;

  function retornar() {
    fetch("/grafico_afastamento/retornar", { // Faz a requisição ao servidor
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      },
    })
      .then(resposta => resposta.json()) // Converte a resposta para JSON
      .then(data => {
        // Atualiza os valores com os dados recebidos do servidor
        qtd_sim_noBancoVar = Number(data.qtd_sim);
        qtd_nao_noBancoVar = Number(data.qtd_nao);

        console.log("Dados recebidos:", qtd_sim_noBancoVar, qtd_nao_noBancoVar);

        // Calcula os percentuais
        calculo_percentual();

        // Cria o gráfico após os dados serem carregados e os percentuais calculados
        criarGraficoAfastamento();
      })
      .catch(erro => {
        console.log(`#ERRO: ${erro}`);
      });
  }

  function calculo_percentual() {
    var total = qtd_sim_noBancoVar + qtd_nao_noBancoVar;
    if (total === 0) {
      percentual_sim = 0;
      percentual_nao = 0;
    } else {
      percentual_sim = (qtd_sim_noBancoVar / total) * 100;
      percentual_nao = (qtd_nao_noBancoVar / total) * 100;
    }

    console.log("percentual_sim:", percentual_sim, "percentual_nao:", percentual_nao);
  }

  function criarGraficoAfastamento() {
    const grafico_afastamento = document.getElementById("canvas_grafico_afastamento");
    new Chart(grafico_afastamento, {
      type: "pie",
      data: {
        labels: ["Sim", "Não"],
        datasets: [
          {
            label: "percentual",
            data: [percentual_sim, percentual_nao],
            backgroundColor: [
              "rgb(75, 192, 192)",
              "rgb(255, 99, 132)",
            ],
            hoverOffset: 2,
          },
        ],
      },
    });
  }

  const grafico_motivo = document.getElementById("canvas_grafico_motivo");
  new Chart(grafico_motivo, {
    type: "bar",
    data: {
      labels: ["Bullying", "Problemas em casa", "Apenas maus entendimentos", "Outros"],
      datasets: [
        {
          label: "votos",
          data: [12, 6, 9, 10],
          backgroundColor: [
            "rgb(255, 99, 132)",
            "rgb(75, 192, 192)",
            "rgb(255, 205, 86)",
            "rgb(201, 203, 207)",
          ],
          hoverOffset: 4
        },
      ],
    },
  });

</script>